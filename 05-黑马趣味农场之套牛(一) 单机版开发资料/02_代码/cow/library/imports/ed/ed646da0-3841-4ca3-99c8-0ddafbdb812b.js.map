{"version":3,"sources":["assets\\scripts\\game.js"],"names":["cc","Class","Component","properties","rope_node","type","Node","cow_ins","rope_imgs","SpriteFrame","cow_prefab","Prefab","time","onLoad","success","scoreNum","start","countDownLabel","find","getComponent","Label","string","schedule","log","resultNode","titleNode","getChildByName","contentNode","contentLabel","active","director","pause","clickCapture","event","customEventDate","setSiblingIndex","y","up","moveTo","x","result","callFunc","currentX","bgNode","node","removeChild","ropeType","randomType","Sprite","spriteFrame","instantiate","addChild","down","finish","scoreLabel","sequence","runAction","closeBtn","resume","loadScene"],"mappings":"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","sourceRoot":"/","sourcesContent":["\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        rope_node: {\r\n            default : null,\r\n            type : cc.Node\r\n        },\r\n        cow_ins: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n\r\n        rope_imgs: {\r\n            default:[],\r\n            type:cc.SpriteFrame\r\n        },\r\n        cow_prefab: {\r\n            default:null,\r\n            type:cc.Prefab\r\n        },\r\n        time:0\r\n\r\n\r\n    },\r\n\r\n    onLoad() {\r\n        this.success = false;\r\n        // 初始分数\r\n        this.scoreNum = 0;\r\n    },\r\n    start () {\r\n        let countDownLabel = cc.find(\"Canvas/bg_sprite/count_down\").getComponent(cc.Label);\r\n        countDownLabel.string = this.time + \"s\";\r\n        this.schedule(function () {\r\n            this.time --;\r\n            countDownLabel.string = this.time + \"s\";\r\n            if (this.time == 0) {\r\n                cc.log(\"游戏结束！\");\r\n                // 获取弹窗节点\r\n                let resultNode = cc.find(\"Canvas/result\");\r\n                // 获取title和content两个节点\r\n                let titleNode = resultNode.getChildByName(\"title\");\r\n                let contentNode = resultNode.getChildByName(\"content\");\r\n                // 展示分数\r\n                titleNode.getComponent(cc.Label).string = \"最终得分 \" + this.scoreNum;\r\n                // 获取组件\r\n                let contentLabel = contentNode.getComponent(cc.Label);\r\n                switch (true) {\r\n                    case this.scoreNum <= 3:\r\n                        contentLabel.string = \"套牛青铜\";\r\n                        break;\r\n                    case this.scoreNum < 6:\r\n                        contentLabel.string = \"套牛高手\";\r\n                        break;\r\n                    case this.scoreNum >= 6:\r\n                        contentLabel.string = \"套牛王者\";\r\n                        break;\r\n\r\n                }\r\n                resultNode.active = true;\r\n                cc.director.pause();\r\n\r\n            }\r\n\r\n        },1);\r\n\r\n    },\r\n\r\n    // update (dt) {},\r\n\r\n    /**\r\n     *  捕获按钮点击事件\r\n     * @param event\r\n     * @param customEventDate\r\n     */\r\n    clickCapture:function (event,customEventDate) {\r\n        this.rope_node.active = true;\r\n        // 设置绳子在当前父节点的顺序\r\n        this.rope_node.setSiblingIndex(100);\r\n\r\n        // 设置绳子起始位置\r\n        this.rope_node.y = -480;\r\n        // 向上移动\r\n        const up = cc.moveTo(0.5,this.rope_node.x,60);\r\n\r\n        // 判定结果\r\n        let result =  cc.callFunc(function () {\r\n            // 获取当前牛儿的x点\r\n            let currentX = this.cow_ins.x;\r\n            if (currentX > -100 && currentX < 100){\r\n                cc.log(\"捕捉成功！\");\r\n                // 移除\r\n                let bgNode = this.node.getChildByName(\"bg_sprite\");\r\n                bgNode.removeChild(this.cow_ins);\r\n                // 获取牛儿的类型\r\n                let ropeType = this.cow_ins.getComponent(\"cow\").randomType +1;\r\n                this.rope_node.getComponent(cc.Sprite).spriteFrame = this.rope_imgs[ropeType];\r\n                // 生成新的牛节点\r\n                this.cow_ins = cc.instantiate(this.cow_prefab);\r\n                this.cow_ins.y = 0;\r\n                bgNode.addChild(this.cow_ins);\r\n                //\r\n                this.success = true;\r\n                // 分数+1\r\n                this.scoreNum ++;\r\n            } else {\r\n                cc.log(\"捕捉失败！\")\r\n            }\r\n\r\n        },this);\r\n        // 往回拉\r\n        let down = cc.moveTo(0.5,this.rope_node.x,-600);\r\n\r\n        let finish = cc.callFunc(function () {\r\n            this.rope_node.getComponent(cc.Sprite).spriteFrame = this.rope_imgs[0];\r\n            // 判断是否捕捉成功\r\n            if (this.success == true) {\r\n                let  scoreLabel = cc.find(\"Canvas/bg_sprite/score\").getComponent(cc.Label);\r\n                scoreLabel.string = \"Score:\" + this.scoreNum;\r\n                this.success = false;\r\n            }\r\n        },this)\r\n\r\n        // 定义一个序列动画\r\n        let sequence = cc.sequence(up,result,down,finish);\r\n        this.rope_node.runAction(sequence);\r\n\r\n\r\n    },\r\n\r\n    // 关闭按钮，继续游戏\r\n    closeBtn() {\r\n        cc.log(\"继续游戏\");\r\n        cc.director.resume();\r\n        cc.director.loadScene(\"game\");\r\n    }\r\n});\r\n"]}